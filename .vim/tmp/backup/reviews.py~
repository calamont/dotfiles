def extract_reviews(data, query=""):
    """Simply 'extract' the full reviews. These can be filtered using keywords
    queries if desired."""
    reviews = []
    idxs = []
    for i, review in enumerate(data.text):
        if any(word.strip().lower() in review.lower() for word in query.split(",")):
            reviews.append(review)
            idxs.append(i)
    data = data.iloc[idxs].copy()
    data["extraction"] = reviews
    data.drop_duplicates(subset=["id", "extraction"])
    return data
