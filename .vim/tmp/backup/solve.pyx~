import numpy as np
cimport numpy as npc
from scipy.linalg.cython_lapack cimport dgesv

ctypedef double DTYPE_t

cdef _solver (double[:,::1] a, double[::1] b):
    cdef int n = a.shape[0], nrhs=a.shape[0], lda=a.shape[0], ldb=b.shape[0], info
    cdef int ipiv
    dgesv(&n, &nrhs, &a[0,0], &lda, &ipiv, &b[0], &ldb, &info)
    return info

def solver (npc.ndarray[DTYPE_t, ndim=2] a, npc.ndarray[DTYPE_t, ndim=1] b):
    # Make copy of array in correct format
    # a_ = np.ascontiguousarray(a.copy().T)
    # b_ = b.copy()
    _solver(a, b)
    # return b_
